---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: frigate
spec:
  interval: 2m
  driftDetection:
    mode: enabled
  chart:
    spec:
      chart: frigate
      version: x
      sourceRef:
        kind: HelmRepository
        name: frigate
  install:
    remediation:
      retries: 3
  upgrade:
    cleanupOnFail: true
    remediation:
      retries: 3
  uninstall:
    keepHistory: false
  values:
    config: |
      mqtt:
        host: "mqtt.example.com"
        port: 1883
        user: admin
        password: "admin"
      cameras:
        alley_front:
          ffmpeg:
            inputs:
              - path: rtsp://frigate:Applegeek1@192.168.50.247:554/Streaming/Channels/1
                roles:
                  - detect
                  - record
          record:
            enabled: true
            retain:
              days: 15
        alley_back:
          ffmpeg:
            inputs:
              - path: rtsp://frigate:Applegeek1@192.168.50.246:554/Streaming/Channels/1
                roles:
                  - detect
                  - record
          record:
            enabled: true
            retain:
              days: 15
        backyard:
          ffmpeg:
            inputs:
              - path: rtsp://lhouge:Applegeek1@192.168.50.249:554/videoMain
                roles:
                  - detect
                  - record
          record:
            enabled: true
            retain:
              days: 15
        house_side:
          ffmpeg:
            inputs:
              - path: rtsp://frigate:Applegeek1@192.168.50.252:554/Streaming/Channels/1
                roles:
                  - detect
                  - record
          record:
            enabled: true
            retain:
              days: 15
        shop_1:
          ffmpeg:
            inputs:
              - path: rtsp://frigate:Applegeek1@192.168.50.250:554/Streaming/Channels/1
                roles:
                  - detect
                  - record
          record:
            enabled: true
            retain:
              days: 15
        shop_2:
          ffmpeg:
            inputs:
              - path: rtsp://frigate:Applegeek1@192.168.50.251:554/Streaming/Channels/1
                roles:
                  - detect
                  - record
          record:
            enabled: true
            retain:
              days: 15

# cameras:
#   back:
#     enabled: True
#     ffmpeg:
#       inputs:
#         - path: rtsp://viewer:{FRIGATE_RTSP_PASSWORD}@10.0.10.10:554/cam/realmonitor?channel=1&subtype=2
#           roles:
#             - audio
#             - detect
#             - record
#             - rtmp
#     best_image_timeout: 60
#     webui_url: ""
#     zones:
#       front_steps:
#         coordinates: 545,1077,747,939,788,805
#         inertia: 3
#         objects:
#           - person
#         filters:
#           person:
#             min_area: 5000
#             max_area: 100000
#             threshold: 0.7
#     onvif:
#       host: 0.0.0.0
#       port: 8000
#       user: admin
#       password: admin
#       autotracking:
#         enabled: False
#         calibrate_on_startup: False
#         zooming: disabled
#         zoom_factor: 0.3
#         track:
#           - person
#         required_zones:
#           - zone_name
#         return_preset: home
#         timeout: 10
#         movement_weights: []
#     birdseye:
#       order: 0
# ui:
#   live_mode: mse
#   use_experimental: False
#   time_format: browser
#   date_style: short
#   time_style: medium
#   strftime_fmt: "%Y/%m/%d %H:%M"
# telemetry:
#   network_interfaces:
#     - eth
#     - enp
#     - eno
#     - ens
#     - wl
#     - lo
#   stats:
#     amd_gpu_stats: True
#     intel_gpu_stats: True
#     network_bandwidth: False
#   version_check: True
