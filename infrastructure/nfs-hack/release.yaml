---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: nfs-subdir-external-provisioner
spec:
  interval: 2m
  postRenderers:
    - kustomize:
        patches:
          - target:
              version: v1
              kind: PersistentVolumeClaim
              # name: frigate-media
            patch: |
              - op: add
                path: /spec/storageClassName
                value: nfs-client-hack  
  chart:
    spec:
      chart: nfs-subdir-external-provisioner
      version: x
      sourceRef:
        kind: HelmRepository
        name: nfs-subdir-external-provisioner
  values:
    storageClass:
      name: nfs-client-hack
      defaultClass: false
      pathPattern: "${NFS_PATHPATTERN}"
    nfs:
      server: ${NFS_SERVER_HACK}
      path: ${NFS_PATH_HACK}
