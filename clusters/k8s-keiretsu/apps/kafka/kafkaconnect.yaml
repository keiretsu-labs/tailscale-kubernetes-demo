apiVersion: kafka.strimzi.io/v1beta2
kind: KafkaConnect
metadata:
  name: tesla-kafka-connect
  namespace: kafka
  labels:
    strimzi.io/cluster: tesla-connect-cluster
spec:
  version: 3.8.0
  replicas: 1
  bootstrapServers: tesla-kafka-bootstrap:9092
  config:
    group.id: "tesla-kafka-connect-group"
    key.converter: "org.apache.kafka.connect.storage.StringConverter"
    value.converter: "org.apache.kafka.connect.converters.ByteArrayConverter" # No transformation applied to data
    config.storage.topic: "connect-configs"
    offset.storage.topic: "connect-offsets"
    status.storage.topic: "connect-statuses"
  externalConfiguration:
    volumes:
      - name: ceph-bucket-tesla
        secret:
          secretName: ceph-bucket-tesla # Kubernetes secret containing AWS credentials
  template:
    pod:
      volumes:
        - name: ceph-bucket-tesla
          secret:
            secretName: ceph-bucket-tesla
      containers:
        - name: kafka-connect
          volumeMounts:
            - name: ceph-bucket-tesla
              mountPath: /opt/kafka/connect/secrets/aws-credentials # Path for AWS credentials