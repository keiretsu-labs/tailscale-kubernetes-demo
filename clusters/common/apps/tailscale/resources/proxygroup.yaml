apiVersion: tailscale.com/v1alpha1
kind: ProxyGroup
metadata:
  name: common-egress
spec:
  hostnamePrefix: ${LOCATION}-common-egress
  tags:
    - tag:k8s
  proxyClass: common
  type: egress
  replicas: 1
---
apiVersion: tailscale.com/v1alpha1
kind: ProxyGroup
metadata:
  name: common-accept-routes-egress
spec:
  hostnamePrefix: ${LOCATION}-common-accept-routes-egress
  tags:
    - tag:k8s
  proxyClass: common-accept-routes
  type: egress
  replicas: 1
---
apiVersion: tailscale.com/v1alpha1
kind: ProxyGroup
metadata:
  name: common-ingress
spec:
  hostnamePrefix: ${LOCATION}-common-ingress
  tags:
    - tag:k8s
  proxyClass: common
  type: ingress
  replicas: 3
---
apiVersion: tailscale.com/v1alpha1
kind: ProxyGroup
metadata:
  name: ${LOCATION}-k8s
spec:
  type: kube-apiserver
  replicas: 2
  tags:
    - tag:k8s
    - tag:${LOCATION}
  kubeAPIServer:
    mode: auth